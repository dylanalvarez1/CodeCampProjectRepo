<head>
  <link rel="stylesheet" href="animate.min.css">
</head>
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"/>
 <meta charset="UTF-8">
<script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src = "https://use.fontawesome.com/4c54c175b1.js"> </script>
<script>
  $(document).ready(function () {
var colors = ["#efeff5", "#f9e6ff", "#e5e5ff", "#ccffe6", "#cfc9af"];
console.log(colors);
var isHidden = true;
var randomQuote = 0;
var tweetText = "https://www.twitter.com";
var tweetCounter = 0;
var target = "https://www.twitter.com";
var oldTarget = "";
var randomIndex;
var newTextColor = 0;
var newColorString = "";
    $("button").click( function () {

      var color = Math.floor(Math.random() * colors.length);
      //alert("The button was clicked");
      //$("#changeText").html("<h1><em>The test text was changed</em></h1>");
      //make a delay in the color change by half a second use setTimeout(function() {"insert code here"}, 500);
      //Choose a random color and ease the transition from colors
      $("body").css({"background-color":colors[color], "transition":"background-color 0.5s ease"});
      console.log(colors[color].replace("#", ""));
      newTextColor = parseInt(colors[color].replace("#", ""),16);
      console.log(newTextColor);
      newTextColor = newTextColor - 999999;
      console.log(newTextColor);
      newColorString = newTextColor.toString(16);
      console.log(newColorString);
      $(".genTextArea").css({"color":newColorString, "transition":"color 0.5s ease"});

      randomQuote = Math.floor(Math.random() *21);
      if($(".genTextArea").css("visibility", "hidden"))
      {
        $(".genTextArea").css("visibility", "visible");
      }
      else {
      //  $(".genTextArea").css("visibility", "hidden");
      }
        //Pull the json data
        $("#fadeText").fadeOut(500, function () {
          $.getJSON(`https://quotesondesign.com/wp-json/posts?filter[orderby]=rand&filter[posts_per_page]=${randomQuote}`, function(json) {
            //Put the quote into the correct html divs
            //Target holds old tweet text


            $("#changeText2").html("<p1 class 'text-right'>~ " + json[randomQuote-1].title + "</p1>");
            $("#changeText").html("<h1 class = ''>" + "<i class='fa fa-quote-left' aria-hidden='true'></i>" + json[randomQuote-1].content +"</h1>");
            //Change the link to tweet the quote out or post on fb
            tweetText = 'https://twitter.com/intent/tweet?text=' + json[randomQuote-1].content + '\n' + ' ~ ' + json[randomQuote-1].title;
            //Fails for one test case:
            /*
As we know,
There are known knowns.
There are things we know we know.
We also know
There are known unknowns.
That is to say
We know there are some things
We do not know.
But there are also unknown unknowns,
The ones we don’t know
We don’t know.
*/
            tweetText = tweetText.replace("<p>", "").replace("</p>","").replace("<br>","").replace("</br>", "").replace("<br />", "");

/*
            if(tweetCounter == 0) {
                target = tweetText;
                $("a[href='https://www.twitter.com']").attr('href', tweetText);
                tweetCounter++;
            }
            */


                console.log("target before: " + target);
                oldTarget = target;
                target = tweetText;
                oldTarget = oldTarget.replace("<p>", "").replace("</p>","").replace("<br>","").replace("</br>", "");
                $(`a[href='https://www.twitter.com']`).attr('href', target);    //Only find the base case href and replaces

                $(`a[href='${oldTarget}']`).attr('href', target);                  //This needs to find the old value and replace it with the new

                console.log("target after: " + target);
                console.log(  $("a[href='" + target + "']"));



/*
            if(tweetCounter == 0) {
              $("a[href=${tweetText}]").attr('href', tweetText);
              tweetCounter++;
            }
*/
          /*
          if (typeof json[randomQuote-1].custom_meta !== 'undefined' && typeof json[randomQuote-1].custom_meta.Source !== 'undefined') {
          $('#changeText3').html('Source: ' + json[randomQuote-1].custom_meta.Source);

        } else {
          $('#changeText3').text('');
        }
        */
          });
        }).fadeIn();






      //Toggle visibility
      $(".genTextArea").css("visibility", "visible");




/*
      if(isHidden) {
        $(".genTextArea").fadeIn(500);
        isHidden = false;
      }
      else {
        $(".genTextArea").fadeOut(500);
        isHidden = true;
      }
      */
      /*
      if($(".genTextArea").css('visibility') === 'visible')
      {
      //  $(".genTextArea").css("visibility", "hidden");

      }
      else
      {
      //  $(".genTextArea").css("visibility", "visible");

      }
      */
       //Make
      //Make selection of colors for every clicked
      //Actually pull a random quote for every click

  });


});
</script>
<style>
body {
  background: #FCFBE3;
}
.quote {
  font-family: gabriola;
  font-size: 45;
}
.Title {
  font-size: 76;
  font-family: Arial;
}
.titleArea {
  border-bottom: 50px;
  margin-top: 100px;
}

.promptArea {



  margin-top: 25px;
  margin-bottom: 0px;
  margin-right:300px;
  margin-left: 300px;
  // border-style: solid;
  // border-color: black;
  // border-width: 3px;
}
.genTextArea {
  background-color: white;
  margin-top: 50px;
  margin-left: 300px;
  margin-bottom: 50px;
  margin-right: 300px;
  padding: 50px;
  border-color: black;
  border-style: solid;
  border-width: 3px;
  visibility : hidden;

}
.button {
  cursor: pointer;
  box-shadow: 0 4px #999;
  margin-bottom: 5px;
  border-radius: 15%;
  size: 500px;
  padding: 15px 70px;
}
.button:hover {background-color: #000080}

.button:active {
  background-color: #000080;
  box-shadow: 0 2px #666;
  transform: translateY(2px);
}
p1 {
  font-family : Monospace;
  font-size: 24;
}
</style>
  <div class = "fluid-container">
  <div class = "text-center titleArea">
    <strong><h1 id = "Title" class = "Title"> Random Quote Machine   </h1></strong>
  </div>
  <div class = "promptArea">

      <div>
        <h4 class = "text-center">  </h4>
        <button class = " button btn btn-primary center-block target offset-9" id = "target1"> Find a Quote!</button>
      </div>

  </div>
      <div class = "genTextArea">
        <div id = "fadeText">
        <h3 id = "changeText"> </h3>
        <p class = "text-right" id = "changeText2"> </p>
        <div></div>
        <p1 class = "text-right" id = "changeText3"> </p1>
        <h1>
        <a href = "https://www.twitter.com" ><i class="fa fa-twitter" aria-hidden="true"></i></a>

      </h1>
      </div>
      </div>
    </div>
